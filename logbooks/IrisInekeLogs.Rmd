---
title: "Logbook Iris Ineke"
author: "Iris Ineke"
date: "2024-09-10"
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax
for authoring HTML, PDF, and MS Word documents. For more details on
using R Markdown see <http://rmarkdown.rstudio.com>.

## inleiding

! inleiding schrijven

## Maandag 9 september

Artikelen gelezen en twee uitgepikt (tweede artikel op aanraden van
Janine).

Invloed RAG in DNA van B-cellen:
<https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE130224>

Leukemie: <https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE103811>

Het artikel over leukemie heeft niet genoeg sampels om goed mee te
kunnen werken deze periode.

Trello aangemaakt.

## Dinsdag 10 september

We hebben besloten dat we het artikel 'RNAseq and TCRseq analysis of
entinostat treated bladder tumors' (PMID: 34396985) gaan gebruiken deze
periode. Dit artikel ziet er interessant uit en is goedgekeurd door
Marcel.

De git repo staat nu ook op mijn laptop met eigen branch (en Ramon heeft
de logboeken aangemaakt).

Het artikel gaat (van wat ik begrijp) over blaaskanker. ICI's
(immune-checkpoint inhibitors) is een manier om de blaaskanker te
bestrijden (De ICI's krijgt de patiënt via een infuus en zorgen ervoor
dat het immuunsysteem beter de tumoren kan bestrijden). Deze vorm van
therapie werkt nog maar bij 20% van de patiënten. Er is dus verbetering
nodig op dit gebied. In dit onderzoek hebben ze met behulp van testen op
muizen laten zien dat entinostat samen met anti–PD-1 helpt tegen
blaaskanker. Entinostat lijkt een vorm van chemotherapie die samen met
een andere stof effectief werkt tegen kanker (door de expressie van
tumor-antigenen te activeren). Anti-PD-1 is in dit geval de andere stof.
PD-1 zorgt er voor dat de t-cel geen andere cel dood (waaronder
kankercel). Anti-PD-1 zal er dus voor zorgen dat je lichaam wel de cel
zal doden.

We hebben een taakverdeling gemaakt voor het plan van aanpak. Ik ga de
planning maken in de vorm van een gantt chart. Eerst moet ik nog even
uitzoeken wat dit precies is !

## Woensdag 11 september

De verdeling een klein beetje aangepast. Vrijdag na de les over de data
downloaden advies vragen over de sample keuzes (hoe besluiten we welke
samples we willen gebruiken en welke niet ?).

## Donderdag 12 september

Vandaag uitzoeken hoe je een gantt chart moet maken. Een gantt chart is
blijkbaar een soort algemeen beeld van de planning. Je kan in word of
excel een gantt chart maken (Excel is mooier). Of in Microsoft Projects.
Microsoft Projects is helaas niet beschikbaar voor ons. Dan is Excel de
beste optie. Vandaag eerst uitzoeken hoe Excel werkt.

Planning uitschrijven van wat we nu weten: Week 1: Maandag 9 september:
artikel vinden rest van de week: plan van aanpak schrijven

Week 2: Maandag 16 september: presentatie plan van aanpak, feedback
verwerken. Dinsdag 17 september - einde week: NGS Quality Control

Week 3: Maandag 23 september - donderdag 26 september: read mapping and
QC Vrijdag 27 september: varient calling

Week 4: Maandag 30 september - einde week: annotation

Week 5: Maandag 7 oktober - einde week: visualisation, plan van aanpak
maken

week 6: Maandag 14 oktober: presentatie plan van aanpak Dinsdag 15
oktober - vrijdag: read mapping and quantification Vrijdag 18 oktober:
Statistics (distributions, normalization, PCA)

Week 7: Maandag 21 oktober - dinsdag?: exploratory data analysis
(chapter 3) Dinsdag 22 oktober: Statistics (batch effects, regression,
linear models) Woensdag 23 oktober: Finding Differentially Expressed
Genes (chapter 4) Vrijdag 25 oktober: Statistics (Enrichment analysis)

Week 8: Maandag 28 oktober - einde week: Data Analysis and Visualization
(chapter 5) Einde week: Hand in Lab Journal

Het lukte even niet in Excel met de data, maar ben er nu achter dankzij
Janine dat Excel met het Amerikaanse data systeem werkt. Dus de maand en
dag moeten andersom. Ik heb nu in Excel een simpele gantt chart gemaakt.
Morgen vragen aan Ronald of Marcel of dit de goede richting is
(Misschien nog periodes (weken) toevoegen als het lukt).

## Vrijdag 13 september

Vandaag heb ik aan Marcel gevraagd of de gantt chart in de goede
richting is. De x-as waar de data staat moet veranderd worden naar de
weeknummers. Vandaag even kijken hoe dat moet. (De duration staat nu in
getallen van 0-1, hoeveel tijd van een week het duurt, waarin 1 een hele
week is). Dat is nu gedaan en het Excel bestand staat in Teams.

## Zaterdag 14 september

Ramon gaf aan dat er nog een taak in moest: Functionele analyse. Die
staat er nu ook in.

Doorgelezen plan van

Kopjes 'entinostat' en 'werking entinostat' samengevoegd: Entinostat is
een zeer selectieve remmer van histondeacetylase (HDAC) 1 en 3. HDAC's
verwijderen acetylgroepen van histonen, wat ervoor zorgt dat DNA
strakker om de histonen wordt gewikkeld, waardoor genen minder
toegankelijk worden voor transcriptieregelaars. Dit onderdrukt de
genexpressie, een proces dat transcriptionele repressie wordt genoemd.
Door HDAC's te remmen, zorgt entinostat ervoor dat het chromatine meer
ontspannen blijft, waardoor genen in het DNA-segment toegankelijk
blijven voor transcriptie. Hierdoor kunnen onderdrukte genen weer actief
worden en worden tegelijkertijd honderden tot duizenden genen
geactiveerd, waaronder veel die betrokken zijn bij immuunprocessen. Dit
leidt ertoe dat de tumoromgeving gaat ontsteken, wat het immuunsysteem
helpt om de tumor aan te vallen. Wat interessant is, is dat veel van de
vaak gemuteerde genen in blaaskanker betrokken zijn bij
histonmodificaties zoals acetylatie. Dit wijst op een mogelijke rol van
epigenetische veranderingen in blaaskanker. Daarom lijken HDAC-remmers,
zoals entinostat, veelbelovend voor de behandeling van blaaskanker.

## Zondag 15 september

Presentatie doorgelezen en spellingsfoutjes aangepast (marp nodig om
html aan te maken van de presentatie).

## Maandag 16 september:

Presentatie gehad plan van aanpak. We hebben besproken hoe we het gaan
aanpakken dat Janine een tijdje niet op school aanwezig kan zijn. Ook
hebben we een verdere taakverdeling gemaakt. Ik moet de komende tijd
inlezen over de tool 'Picard'.

## Dinsdag 17 september:

Testdata maken: Met find maak je een list van de bestanden die in de map
staan met alle data (je geeft het pad daarnaar mee). Vervolgens paralell
(zorgt voor efficientie): Neemt de eerste 10% van elk bestand en print
die (van elk bestand) in een nieuw bestand in de folder testdataIris.

```{bash, eval=FALSE}
find /students/2024-2025/Thema05/BlaasKanker/fastq -name "*.fastq" | \
  parallel "seqkit sample -p 0.1 {} | seqkit head -n 10000 > /students/2024-2025/Thema05/BlaasKanker/oefenengroep/testdataIris/{/}"
```

fastqc: kwaliteitscontrole report Je roept de tool aan en geeft de input
en met -o de plek waar de output heen moet.

```{bash, eval=FALSE}
fastqc /students/2024-2025/Thema05/BlaasKanker/oefenengroep/testdataIris/*  \
  -o /students/2024-2025/Thema05/BlaasKanker/oefenengroep/fastqcIris/
```

multiqc: samenvoegen alle fastqc files: Je roept de tool aan en geeft de
input en met -o de plek waar de output heen moet.

```{bash, eval=FALSE}
multiqc /students/2024-2025/Thema05/BlaasKanker/oefenengroep/fastqcIris/ -o /students/2024-2025/Thema05/BlaasKanker/oefenengroep/multiqcIris/
```

Je kan nu het report zien door: Op de school pc in te loggen en via de
terminal naar de goede map te gaan
(/students/2024-2025/Thema05/BlaasKanker/oefenengroep/multiqcIris/)
Vervolgens typ je 'firefox multiqc_report.html' Nu opent hij je browser
met het report.

Begonnen inlezen Picard: Morgen downloaden en installeren. Eerst kijken
of de juiste versie van java(1.8.x) geïnstalleerd is. En een environment
variabele opzetten als shortcut.

We hebben een recent genoege versie van java, dus dat is al goed
geregeld.

## Woensdag 18 september

nieuw deel: trimmomatic: De code voor de testdata: de eerste regel
(begint bij cat) zorgt ervoor dat de namen van de
files(SRR_Acc_List.txt) worden ingeveuld bij parallel tussen de {} als
de input files. We geven 2 paden mee voor de input files en 4 voor de
output files(2 paired en 2 unpaired). De minimale lengte(minlen) dat een
stuk moet zijn staat op 40 op aanraden van Marcel. En de slidingwindow
hebben we op de standaard instelling gelaten. De eerste keer runnen
werkte het niet, omdat we de adapter nog moesten downloaden.

```{bash, eval=FALSE}
cat /students/2024-2025/Thema05/BlaasKanker/SRR_Acc_List.txt | \
  parallel 'TrimmomaticPE -threads 4 ' \
                  '/students/2024-2025/Thema05/BlaasKanker/testdata/{}_1.fastq' \
                  '/students/2024-2025/Thema05/BlaasKanker/testdata/{}_2.fastq' \
                  '/students/2024-2025/Thema05/BlaasKanker/testingtools/testing_trim/{}_paired.1.fastq ' \
                  '/students/2024-2025/Thema05/BlaasKanker/testingtools/testing_trim/{}_unpaired.1.fastq ' \
                  '/students/2024-2025/Thema05/BlaasKanker/testingtools/testing_trim/{}_paired.2.fastq ' \
                  '/students/2024-2025/Thema05/BlaasKanker/testingtools/testing_trim/{}_unpaired.2.fastq ' \
                  'ILLUMINACLIP:/students/2024-2025/Thema05/BlaasKanker/tools/trim_adapters/TruSeq3-PE.fa:2:30:10 ' \
                  'MINLEN:40 ' \
                  'SLIDINGWINDOW:4:20'
```

De code voor de echte data: De paden aangepast naar de files van de
echte data.

```{bash, eval=FALSE}
cat /students/2024-2025/Thema05/BlaasKanker/SRR_Acc_List.txt | \
  parallel 'TrimmomaticPE -threads 8 ' \
                  '/students/2024-2025/Thema05/BlaasKanker/fastq/{}_1.fastq' \
                  '/students/2024-2025/Thema05/BlaasKanker/fastq/{}_2.fastq' \
                  '/students/2024-2025/Thema05/BlaasKanker/fastq_trimmed/{}_paired.1.fastq ' \
                  '/students/2024-2025/Thema05/BlaasKanker/fastq_trimmed/{}_unpaired.1.fastq ' \
                  '/students/2024-2025/Thema05/BlaasKanker/fastq_trimmed/{}_paired.2.fastq ' \
                  '/students/2024-2025/Thema05/BlaasKanker/fastq_trimmed/{}_unpaired.2.fastq ' \
                  'ILLUMINACLIP:/students/2024-2025/Thema05/BlaasKanker/tools/trim_adapters/TruSeq3-PE.fa:2:30:10 ' \
                  'MINLEN:40 ' \
                  'SLIDINGWINDOW:4:20'
```

Deze laten runnen op de school server (die mappen waar ze steeds heen
gaan moet je eerst zelf aanmaken).

## Donderdag 19 september:

De terminal zegt dat hij de Trimmomatic succesvol heeft afgerond, maar
hij print nog wel (wat lijkt op html) code. Geen idee waarom. Via 'htop'
kun je ook zien dat hij nog wel een deel van de server inneemt, dus hij
is nog wel ergens mee bezig, maar zou niet weten wat. Het duurde zo lang
dat ik hem heb gestopt. Ramon heeft het opnieuw geprobeerd. Uit de
poging van Ramon op de test data blijkt dat de kwaliteit achteruit gaat
na het trimmen, wat gek is. Maar dit kan liggen aan dat de sub sets wat
klein zijn ? Morgen vragen in de les hoe dit kan.

## Vrijdag 20 september:

Na echt heel lang bezig te zijn geweest was Trimmomatic eindelijk klaar
op Ramon zijn laptop en de kwaliteit van de data is inderdaad echt
achteruit gegaan. We hebben Ronald gevraagd wat een mogelijke oorzaak is
hiervan. Ronald gaf als mogelijkheid dat de reads heel kort zijn en dat
er daardoor veel goede reads worden weggegooid omdat ze zo kort zijn. We
hebben dus de minlen aangepast naar 20 in plaats van 40. Maar de
kwaliteit van de data ging nog steeds achteruit. We moeten nog even
uitzoeken hoe dit kan en of we hier iets aan kunnen doen. Als het echt
steeds slechter wordt dan kunnen we ervoor kiezen om geen trimmomatic
uit te voeren op de data, omdat de data zelf al best goed is. Maar eerst
gaan we proberen of we het kunnen verbeteren. Maar het is wel
opmerkelijk.

## Zaterdag 21 september:

Ik denk dat we in trimmomatic kunnen aangeven dat het einde getrimd moet
worden. Dit is handig omdat in de fastqc analyze af te lezen is dat in
de 'per base sequence quality plot' het einde de kwaliteit minder werd.

## Zondag 22 september

Onderstaande code zijn de aangepaste instellingen voor Trimmomatic.

```{bash, eval=FALSE}
cat /students/2024-2025/Thema05/BlaasKanker/SRR_Acc_List.txt | \
  parallel 'TrimmomaticPE -threads 4' \
                  '/students/2024-2025/Thema05/BlaasKanker/testdata/{}_1.fastq' \
                  '/students/2024-2025/Thema05/BlaasKanker/testdata/{}_2.fastq' \
                  '/students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest/{}_paired.1.fastq' \
                  '/students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest/{}_unpaired.1.fastq' \
                  '/students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest/{}_paired.2.fastq' \
                  '/students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest/{}_unpaired.2.fastq' \
                  'ILLUMINACLIP:/students/2024-2025/Thema05/BlaasKanker/tools/trim_adapters/TruSeq3-PE.fa:2:30:10' \
                  'SLIDINGWINDOW:4:20' \
                  'MINLEN:40'
```

Spaties weggehaald aan de eindes van elke regel tussen de ' '. geen idee
of dat invloed heeft verder. Illuminaclip hebben we nodig om de adapters
van de reads te halen. Slidingwindow is handig om de kwaliteit te
checken van de reads. Minlen is handig om de korte reads eruit te halen.

Ik heb ervoor gekozen om slidingwindow voor minlen uit te laten voeren,
omdat als je eerst de minlen uitvoert en daarna de slidingwindow er een
kans is dat er alsnog reads zijn die korter zijn dan de minlen
(aangezien je de slidingwindow nog basenparen kan weg trimmen).

Nu FastQC en multiQC op de getrimde documenten uitvoeren: Map aanmaken
in testingtools: trimtest_fastqc

```{bash, eval=FALSE}
fastqc /students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest/*  \
  -o /students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest_fastqc
```

Map aanmaken in testingtools: trimtest_multiqc

```{bash, eval=FALSE}
multiqc /students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest_fastqc -o /students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest_multiqc
```

Hoe open ik het report nu zonder de school computer? 'scp -r pad_vanaf
pad_naar' Oke uit het raport komt nog steeds dat de data slechter wordt.
De Sequence Length Distribution is nu nog oranje, maar de duplication
levels zijn wel beter dan voor trimmomatic.

De 'sequence length distribution' is te hoog, dus minlen verhogen naar
90 (uit grafiek fastqc).

De slidingwindow ook veranderen: '4:30' in plaats van '4:20' (uit
grafiek: 'sequence qualty histograms gehaald)

Oke. Uit de plot 'sequence quality histograms' kun je aflezen dat het
begin van de reads nog beter kunnen, dus 'leading:32' toevoegen (32 uit
de grafiek gehaald: 'sequence quality histogram). ! Niet vergeten nieuwe
mappen te maken voor je trimmomatic opieuw probeert ! Nieuwe poging:

```{bash, eval=FALSE}
cat /students/2024-2025/Thema05/BlaasKanker/SRR_Acc_List.txt | \
  parallel 'TrimmomaticPE -threads 4' \
                  '/students/2024-2025/Thema05/BlaasKanker/testdata/{}_1.fastq' \
                  '/students/2024-2025/Thema05/BlaasKanker/testdata/{}_2.fastq' \
                  '/students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest2/{}_paired.1.fastq' \
                  '/students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest2/{}_unpaired.1.fastq' \
                  '/students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest2/{}_paired.2.fastq' \
                  '/students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest2/{}_unpaired.2.fastq' \
                  'ILLUMINACLIP:/students/2024-2025/Thema05/BlaasKanker/tools/trim_adapters/TruSeq3-PE.fa:2:30:10' \
                  'LEADING:32' \
                  'SLIDINGWINDOW:4:30' \
                  'MINLEN:90'
```

(hij gaf een foutmelding; er miste een slash achter de leading. hierdoor
moet ik de file weer leegmaken met 'rm \*')

nu doet hij het wel.

Vervolgens: maak map in testingtools: trimtest_fastqc2 FastQC op poging
drie trim:

```{bash, eval=FALSE}
fastqc /students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest2/*  \
  -o /students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest_fastqc2
```

Vervolgens: maak map in testingtools: trimtest_multiqc2

```{bash, eval=FALSE}
multiqc /students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest_fastqc2 -o /students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest_multiqc2
```

Vervolgens de report naar eigen laptop zetten om te openen: in eigen
terminal:

```{bash, eval=FALSE}
scp -r ieineke@bioinf.nl:/students/2024-2025/Thema05/BlaasKanker/testingtools/trimtest_multiqc2/ .
```

Oke de 'Sequence Length Distribution' kan nog steeds beter, maar de
'Sequence Quality Histograms' ziet er al wat beter uit. Ik denk dat de
minlen helemaal naar 97 moet. Dus alles weer opnieuw, maar dan met de
minlen op 97.

! Per ongeluk de verkeerde terminal gebruikt, nu staat het report in
mijn branch op git in plaats van mijn laptop. Later even verwijderen.

Ik heb per ongeluk precies hetzelfde gedaan zonder de nieuwe
instellingen. Dus alle mappen weer legen enzovoort. Ik heb per ongeluk
de trimmomatic in de map gezet van de vorige poging, dus die map kan ook
wel weg nu.

Oke. De sequence length distribution is nog steeds niet goed genoeg. Ik
lees de grafiek dan denk k verkeerd af. Ik snap het niet meer. Dinsdag
even vragen. (folder waar het report in staat heet:
'trimtest_multiqc3').

## Dinsdag 24 september:

Planning voor komende week gemaakt samen. We moeten even vragen of we de
duplicaten (die niet goed zijn) moeten verbeteren met picard (tool). Als
dit zo is ga ik daarmee verder. Zo niet gaan Ramon en ik samen bezig met
Strelka.

picard downloaden: Eerst de link kopieren van de git ('picard.jar' bij
versie 3.2.0): nieuwe folder maken in terminal: 'picard'

de tool downloaden op de school terminal:

```{bash, eval=FAlSE}
wget https://github.com/broadinstitute/picard/releases/download/3.2.0/picard.jar
```

de file unzippen (was achteraf niet nodig):

```{bash, eval=FAlSE}
unzip picard.jar 
```

de help van de tool:

```{bash, eval=FAlSE}
java -jar picard.jar -h
```


! unpaired eruit halen multi report voor betrouwbaardere output op aanraden van Ramon

Omdat na de trimming de duplicatie levels goed zijn. Is Picard niet meer
nodig. Dus nu gaan Ramon en ik samen inlezen over Trelka. Ramon heeft
mij toegang gegeven tot de door hem gedownloade tool (wat dus een
rechten probleem bleek te zijn). Wat ik deze week dus moet doen: Morgen
gaan we de instellingen bepalen van Trimmomatic. Verder uitzoeken hoe we
Trelka moeten gebruiken voor varient calling.

Ramon had een tabel gedeeld in teams, deze is handig om een een oog opzicht je instellingen van verschillende pogingen van Trimmomatic te zien:

| Run ID                             | LEADING | TRAILING | SLIDING WINDOW | MINLEN | AVGQUAL | HEADCROP | CROP | ILLUMINACLIP           |
|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| poging 1                           | NONE    | NONE     | 4:20           | 40     | NONE    | NONE     | NONE | TruSeq3-PE.fa:2:30:10' |
| minlen en slidingwindow omgedraait | 32      |          | 4:20           | 40     |         |          |      | TruSeq3-PE.fa:2:30:10' |
| poging 3                           | 32      |          | 4:30           | 97     |         |          |      | TruSeq3-PE.fa:2:30:10' |


! uitzoeken documentatie, germline of die ander. tumor.bam hebben we ms
niet

! kijken of Whole exome sequencing invloed kan hebben op duplicaties

